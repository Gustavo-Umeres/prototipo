<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bienestar Contigo - Prototipo</title>
    <!-- Incluyendo Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Incluyendo Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Configuraci贸n de color y fuente para Tailwind */
        :root {
            --color-primary: #1e40af; /* Azul oscuro para botones/茅nfasis */
            --color-secondary: #fcd34d; /* Amarillo para acentos */
            --color-success: #10b981; /* Verde para calma */
            --color-danger: #ef4444; /* Rojo para estr茅s */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        /* Estilos para el men煤 lateral (Drawer) */
        .drawer-overlay {
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s, visibility 0.3s;
        }
        .drawer-content {
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
        }
        .drawer-open .drawer-overlay {
            visibility: visible;
            opacity: 1;
        }
        .drawer-open .drawer-content {
            transform: translateX(0);
        }
        
        /* Animaci贸n de carga */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            z-index: 50;
            justify-content: center;
            align-items: center;
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--color-primary);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Ocultar navegaci贸n y bot贸n flotante en la vista de bienvenida */
        .hide-on-welcome {
            display: none;
        }
    </style>
</head>
<body class="min-h-screen">

    <!-- Contenedor Principal de la App (Responsive Wrapper) -->
    <div id="app-container" class="max-w-md mx-auto bg-white min-h-screen shadow-lg">
        
        <!-- Overlay de Carga (para simular el pago/proceso) -->
        <div id="loading-overlay" class="loading-overlay">
            <div class="flex flex-col items-center p-6 bg-white rounded-xl shadow-lg">
                <div class="spinner mb-4"></div>
                <p class="text-gray-700 font-semibold">Procesando cita...</p>
            </div>
        </div>

        <!-- Header (Estilo SuperMamaApp) -->
        <header id="app-header" class="bg-primary p-4 flex justify-between items-center sticky top-0 z-20 shadow-md hide-on-welcome">
            <button onclick="toggleDrawer()" aria-label="Abrir Men煤" class="text-white p-1 rounded-md hover:bg-blue-700 transition">
                <i data-lucide="menu" class="w-7 h-7"></i>
            </button>
            <h1 class="text-2xl font-extrabold text-white">Bienestar Contigo</h1>
            <button aria-label="Notificaciones" class="text-white p-1 rounded-md hover:bg-blue-700 transition">
                <i data-lucide="bell" class="w-6 h-6"></i>
            </button>
        </header>

        <!-- Contenido de las Vistas -->
        <main id="content" class="p-4 pb-20">
            <!-- El contenido se cargar谩 aqu铆 por JavaScript -->
        </main>
        
        <!-- Bot贸n Flotante de Registro R谩pido (Bit谩cora) -->
        <button id="floating-btn" onclick="showPage('log')" aria-label="Registro R谩pido" 
                class="fixed bottom-6 right-6 md:right-1/2 md:translate-x-[220px] 
                       bg-red-600 hover:bg-red-700 text-white p-4 rounded-full 
                       shadow-2xl transition duration-150 transform hover:scale-110 z-30 hide-on-welcome">
            <i data-lucide="plus" class="w-6 h-6"></i>
        </button>

        <!-- Barra de Navegaci贸n Inferior (Alternativa para m贸vil) -->
        <nav id="bottom-nav" class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 max-w-md mx-auto flex justify-around p-2 z-20 shadow-inner hide-on-welcome">
            <button id="nav-home" class="flex flex-col items-center p-2 rounded-xl transition-colors active-page" onclick="showPage('home')">
                <i data-lucide="layout-dashboard" class="nav-icon active w-6 h-6"></i>
                <span class="text-xs mt-1 text-primary font-semibold">Inicio</span>
            </button>
            <button id="nav-log" class="flex flex-col items-center p-2 rounded-xl transition-colors" onclick="showPage('log')">
                <i data-lucide="book-open" class="nav-icon w-6 h-6"></i>
                <span class="text-xs mt-1 text-gray-500">Bit谩cora</span>
            </button>
            <button id="nav-info" class="flex flex-col items-center p-2 rounded-xl transition-colors" onclick="showPage('info')">
                <i data-lucide="info" class="nav-icon w-6 h-6"></i>
                <span class="text-xs mt-1 text-gray-500">Info</span>
            </button>
            <button id="nav-appointment" class="flex flex-col items-center p-2 rounded-xl transition-colors" onclick="showPage('appointment')">
                <i data-lucide="calendar-check" class="nav-icon w-6 h-6"></i>
                <span class="text-xs mt-1 text-gray-500">Citas</span>
            </button>
        </nav>

        <!-- Men煤 Lateral (Drawer) -->
        <div id="drawer" class="drawer-overlay fixed inset-0 z-40">
            <!-- Overlay -->
            <div onclick="toggleDrawer()" class="absolute inset-0 bg-black bg-opacity-50"></div>
            <!-- Contenido del Men煤 -->
            <div class="drawer-content fixed top-0 left-0 h-full w-64 bg-white shadow-xl flex flex-col">
                <div class="bg-primary p-6 text-white text-lg font-bold">
                    Men煤 Principal
                </div>
                <nav class="flex flex-col p-4 space-y-2">
                    <a href="#" onclick="showPage('home'); toggleDrawer()" class="flex items-center p-3 rounded-xl hover:bg-gray-100 text-gray-700 font-medium">
                        <i data-lucide="layout-dashboard" class="w-5 h-5 mr-3 text-primary"></i> Inicio
                    </a>
                    <a href="#" onclick="showPage('log'); toggleDrawer()" class="flex items-center p-3 rounded-xl hover:bg-gray-100 text-gray-700 font-medium">
                        <i data-lucide="book-open" class="w-5 h-5 mr-3 text-primary"></i> Bit谩cora / Registro
                    </a>
                    <a href="#" onclick="showPage('info'); toggleDrawer()" class="flex items-center p-3 rounded-xl hover:bg-gray-100 text-gray-700 font-medium">
                        <i data-lucide="info" class="w-5 h-5 mr-3 text-primary"></i> Info y Recetas
                    </a>
                    <a href="#" onclick="showPage('appointment'); toggleDrawer()" class="flex items-center p-3 rounded-xl hover:bg-gray-100 text-gray-700 font-medium">
                        <i data-lucide="calendar-check" class="w-5 h-5 mr-3 text-primary"></i> Reservar Cita Psicol贸gica
                    </a>
                    <div class="border-t border-gray-200 mt-4 pt-4">
                        <a href="#" class="flex items-center p-3 rounded-xl text-sm text-gray-500 hover:bg-gray-100">
                            <i data-lucide="settings" class="w-5 h-5 mr-3"></i> Configuraci贸n
                        </a>
                        <a href="#" onclick="showPage('welcome')" class="flex items-center p-3 rounded-xl text-sm text-red-500 hover:bg-red-50">
                            <i data-lucide="log-out" class="w-5 h-5 mr-3"></i> Cerrar Sesi贸n
                        </a>
                    </div>
                </nav>
                <div class="mt-auto p-4 text-xs text-gray-400 border-t">
                    漏 2024 Bienestar Contigo
                </div>
            </div>
        </div>

    </div>

    <!-- Modal para el Kit de Primeros Auxilios -->
    <div id="modal-kit" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl p-6 shadow-2xl max-w-sm w-full transform transition-all scale-100">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-red-600 flex items-center">
                    <i data-lucide="shield-alert" class="w-6 h-6 mr-2"></i>
                    Alerta de Estr茅s
                </h3>
                <button onclick="closeModal('modal-kit')" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            <p class="text-gray-700 mb-4">隆Alto! Sentir culpa o estr茅s es normal. T贸mate 2 minutos para el "Kit de Calma".</p>
            <button onclick="startCalmKit()" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition duration-150 transform hover:scale-105">
                Iniciar Kit de Calma (5-4-3-2-1)
            </button>
        </div>
    </div>
    
    <!-- Modal de Confirmaci贸n de Cita -->
    <div id="modal-appointment-confirm" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl p-6 shadow-2xl max-w-sm w-full transform transition-all scale-100">
            <h3 class="text-xl font-bold text-gray-800 mb-4">Confirmar Cita</h3>
            <p class="text-gray-700 mb-4">Est谩s a punto de agendar tu cita psicol贸gica por **S/ 60**. Recuerda que este precio accesible incluye el margen de S/ 15 para la app. 驴Confirmas el pago y agendamiento?</p>
            <div class="flex justify-end space-x-3">
                <button onclick="closeModal('modal-appointment-confirm')" class="px-4 py-2 text-gray-600 rounded-xl hover:bg-gray-100 transition">
                    Cancelar
                </button>
                <button onclick="processPayment()" class="px-4 py-2 bg-green-500 hover:bg-green-600 text-white font-bold rounded-xl shadow-md transition">
                    S铆, Pagar S/ 60
                </button>
            </div>
        </div>
    </div>


    <script>
        // Inicializar Lucide Icons
        lucide.createIcons();

        // ** SIMULACIN DE BD SIMPLE (Bit谩cora) **
        // Array para almacenar entradas durante la sesi贸n
        let logEntries = [
            { time: '08:00 AM', type: 'Desayuno', content: 'Desayuno en casa', color: 'border-primary' },
            { time: '10:00 AM', type: 'Emoci贸n', content: 'Emoci贸n registrada (Motivado)', color: 'border-success' }
        ];

        // --- Manejo del Men煤 Lateral (Drawer) ---
        function toggleDrawer() {
            document.getElementById('drawer').classList.toggle('drawer-open');
        }

        // --- Manejo de la Navegaci贸n (Single Page App) ---
        let currentPage = 'welcome';
        const contentDiv = document.getElementById('content');
        const navButtons = {
            home: document.getElementById('nav-home'),
            log: document.getElementById('nav-log'),
            info: document.getElementById('nav-info'),
            appointment: document.getElementById('nav-appointment')
        };
        const loadingOverlay = document.getElementById('loading-overlay');
        const header = document.getElementById('app-header');
        const bottomNav = document.getElementById('bottom-nav');
        const floatingBtn = document.getElementById('floating-btn');


        function updateAppUI(pageId) {
            const isWelcome = pageId === 'welcome';
            const action = isWelcome ? 'add' : 'remove';
            
            // Ocultar/Mostrar elementos de navegaci贸n
            header.classList[action]('hide-on-welcome');
            bottomNav.classList[action]('hide-on-welcome');
            floatingBtn.classList[action]('hide-on-welcome');

            // Ajustar padding del main content si es la vista de bienvenida (sin nav)
            contentDiv.classList.toggle('pb-20', !isWelcome); 
            contentDiv.classList.toggle('min-h-screen', isWelcome); 
        }

        function showPage(pageId) {
            currentPage = pageId;
            updateAppUI(pageId); 

            if (pageId !== 'welcome') {
                updateNavigation(pageId);
            }
            renderContent(pageId);
            
            if (document.getElementById('drawer').classList.contains('drawer-open')) {
                toggleDrawer();
            }
            // Re-renderizar iconos de Lucide y actualizar la Bit谩cora
            setTimeout(() => {
                lucide.createIcons();
                if (pageId === 'log') {
                    renderLogList();
                }
            }, 50);
        }

        function updateNavigation(pageId) {
            Object.keys(navButtons).forEach(key => {
                const btn = navButtons[key];
                const icon = btn.querySelector('i');
                const text = btn.querySelector('span');
                
                // Resetear clases
                text.classList.remove('text-primary', 'font-semibold');
                text.classList.add('text-gray-500');

                if (key === pageId) {
                    text.classList.add('text-primary', 'font-semibold');
                    text.classList.remove('text-gray-500');
                }
            });
        }

        // --- Vistas/Contenido de la App (HTML Templates) ---
        const pages = {
            welcome: `
                <div class="flex flex-col items-center justify-center min-h-[calc(100vh-2rem)] p-6 text-center">
                    <div class="bg-primary p-8 rounded-full mb-6 shadow-xl">
                        <i data-lucide="heart-pulse" class="w-16 h-16 text-white"></i>
                    </div>
                    <h1 class="text-4xl font-extrabold text-primary mb-3">Bienestar Contigo</h1>
                    <p class="text-lg text-gray-700 mb-8">Tu acompa帽ante emocional y pr谩ctico para manejar la diabetes tipo 2 sin estr茅s ni culpa.</p>
                    
                    <button onclick="showPage('home')" class="w-full bg-success hover:bg-green-600 text-white font-bold py-3 px-4 rounded-xl mb-3 shadow-lg transition duration-150 transform hover:scale-[1.01]">
                        Iniciar Sesi贸n
                    </button>
                    <button onclick="showPage('home')" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-3 px-4 rounded-xl shadow transition duration-150">
                        Crear Cuenta
                    </button>
                    <p class="text-sm text-gray-500 mt-4">Al acceder, aceptas los t茅rminos de servicio.</p>
                </div>
            `,
            home: `
                <div class="space-y-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">隆Hola! Es hora de tu registro emocional</h2>
                    
                    <!-- Medidor Emocional Diario -->
                    <div class="bg-white p-5 rounded-2xl shadow-lg border border-gray-100">
                        <h2 class="text-xl font-bold text-gray-800 mb-3 flex items-center">
                            <i data-lucide="trending-up" class="w-5 h-5 mr-2 text-primary"></i>
                            Tu Bienestar Hoy
                        </h2>
                        <p class="text-sm text-gray-600 mb-4">驴C贸mo te sientes en este momento? (Punto de dolor clave)</p>
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-4xl cursor-pointer hover:scale-110 transition duration-150" onclick="recordEmotion('Muy Estresado')">
                                
                            </span>
                            <span class="text-4xl cursor-pointer hover:scale-110 transition duration-150" onclick="recordEmotion('Cansado/Culpable')">
                                
                            </span>
                            <span class="text-4xl cursor-pointer hover:scale-110 transition duration-150" onclick="recordEmotion('Neutral')">
                                
                            </span>
                            <span class="text-4xl cursor-pointer hover:scale-110 transition duration-150" onclick="recordEmotion('Tranquilo')">
                                
                            </span>
                            <span class="text-4xl cursor-pointer hover:scale-110 transition duration-150" onclick="recordEmotion('Motivado')">
                                
                            </span>
                        </div>
                        <p id="emotion-status" class="text-center font-semibold text-gray-700">Selecciona tu emoci贸n...</p>
                    </div>

                    <!-- Bot贸n Destacado: Kit de Calma -->
                    <button onclick="openModal('modal-kit')" class="w-full bg-yellow-500 hover:bg-yellow-600 text-gray-800 font-bold py-3 px-4 rounded-xl shadow-lg transition duration-150 transform hover:scale-[1.01] flex items-center justify-center">
                        <i data-lucide="zap" class="w-5 h-5 mr-2"></i>
                        Kit de Primeros Auxilios Emocionales
                    </button>

                    <!-- Resumen del D铆a -->
                    <div class="bg-white p-5 rounded-2xl shadow-lg border border-gray-100">
                        <h2 class="text-xl font-bold text-gray-800 mb-3 flex items-center">
                            <i data-lucide="clipboard-check" class="w-5 h-5 mr-2 text-success"></i>
                            Tus Logros de Hoy
                        </h2>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <span class="text-gray-700">Registro de Emoci贸n</span>
                                <i data-lucide="check-circle" class="w-6 h-6 text-success"></i>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-gray-700">Comida Saludable</span>
                                <i data-lucide="x-circle" class="w-6 h-6 text-danger"></i>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-gray-700">Actividad F铆sica (Pasos)</span>
                                <span class="font-bold text-gray-900">3,450 / 8,000</span>
                            </div>
                        </div>
                    </div>
                </div>
            `,
            log: `
                <div class="space-y-6">
                    <!-- T铆tulo de Bit谩cora -->
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">Bit谩cora Diario (Registro)</h2>
                    
                    <!-- Registro de Comida (Simplificado como Aprendimos) -->
                    <div class="bg-white p-5 rounded-2xl shadow-lg border border-gray-100">
                        <h3 class="text-lg font-bold text-gray-800 mb-3">驴Qu茅 almorzaste?</h3>
                        <p class="text-sm text-gray-600 mb-4">Simplifica tu registro para reducir la carga mental.</p>
                        <div class="flex flex-wrap justify-between gap-3">
                            <button class="flex flex-col items-center justify-center p-3 bg-gray-100 hover:bg-gray-200 rounded-xl transition duration-150 shadow-sm w-[calc(33%-6px)]" onclick="logEntry('Comida: Casa')">
                                <i data-lucide="home" class="w-6 h-6 text-primary mb-1"></i>
                                <span class="text-xs text-gray-700 font-semibold">Casa</span>
                            </button>
                            <button class="flex flex-col items-center justify-center p-3 bg-gray-100 hover:bg-gray-200 rounded-xl transition duration-150 shadow-sm w-[calc(33%-6px)]" onclick="logEntry('Comida: Calle')">
                                <i data-lucide="truck" class="w-6 h-6 text-yellow-600 mb-1"></i>
                                <span class="text-xs text-gray-700 font-semibold">Calle</span>
                            </button>
                            <button class="flex flex-col items-center justify-center p-3 bg-gray-100 hover:bg-gray-200 rounded-xl transition duration-150 shadow-sm w-[calc(33%-6px)]" onclick="logEntry('Comida: Antojo')">
                                <i data-lucide="cookie" class="w-6 h-6 text-red-600 mb-1"></i>
                                <span class="text-xs text-gray-700 font-semibold">Antojo</span>
                            </button>
                        </div>
                    </div>

                    <!-- Lista de Bit谩cora -->
                    <div class="bg-white p-5 rounded-2xl shadow-lg border border-gray-100">
                        <h3 class="text-lg font-bold text-gray-800 mb-3">Tu Historial de Hoy</h3>
                        <ul id="log-list" class="space-y-2 text-sm text-gray-700">
                            <!-- Los registros se llenar谩n aqu铆 con renderLogList() -->
                        </ul>
                    </div>
                </div>
            `,
            info: `
                <div class="space-y-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">Informaci贸n y Recetas (Gu铆a Sin Culpa)</h2>

                    <!-- M贸dulo de B煤squeda -->
                    <div class="bg-white p-4 rounded-2xl shadow-lg border border-gray-100">
                        <h3 class="text-lg font-bold text-gray-800 mb-3">Recetas Econ贸micas de VES (Basado en Aprendizaje A)</h3>
                        <p class="text-sm text-gray-600 mb-4">Opciones saludables con alimentos locales y baratos.</p>
                        <div class="relative">
                            <input type="text" placeholder="Ej: Lentejas, Pollo a la brasa, Quinua..." class="w-full p-3 pl-10 border border-gray-300 rounded-xl focus:ring-primary focus:border-primary">
                            <i data-lucide="search" class="w-5 h-5 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2"></i>
                        </div>
                    </div>

                    <!-- Consejos Principales -->
                    <div class="space-y-3">
                        <div class="bg-white p-4 rounded-xl shadow-md flex items-center space-x-3">
                            <div class="p-2 bg-yellow-100 rounded-full">
                                <i data-lucide="egg" class="w-6 h-6 text-yellow-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-800">Truco del Huevo Frito</h4>
                                <p class="text-sm text-gray-600">Acompa帽a el arroz con m谩s vegetales para bajar el 铆ndice gluc茅mico total.</p>
                            </div>
                        </div>
                        <div class="bg-white p-4 rounded-xl shadow-md flex items-center space-x-3">
                            <div class="p-2 bg-green-100 rounded-full">
                                <i data-lucide="leaf" class="w-6 h-6 text-green-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-800">Menos Carbo, M谩s Fibra</h4>
                                <p class="text-sm text-gray-600">Usa quinua en lugar de papa para tus guisos sin aumentar el costo.</p>
                            </div>
                        </div>
                    </div>
                </div>
            `,
            appointment: `
                <div class="space-y-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">Agendar Cita Psicol贸gica</h2>

                    <!-- Informaci贸n del Servicio -->
                    <div class="bg-white p-5 rounded-2xl shadow-lg border border-gray-100">
                        <h3 class="text-xl font-bold text-primary mb-3">Apoyo Profesional Accesible (Prueba de Viabilidad)</h3>
                        <p class="text-gray-700 mb-3">Agenda una sesi贸n confidencial de 45 min con un psic贸logo especializado en estr茅s cr贸nico y diabetes.</p>
                        <div class="flex items-center justify-between p-3 bg-blue-50 rounded-xl">
                            <span class="font-bold text-gray-800">Costo por Sesi贸n:</span>
                            <span class="text-2xl font-extrabold text-green-600">S/ 60</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-2">*(Tu costo es S/ 60; S/ 45 para el psic贸logo, S/ 15 de margen para la app)*</p>
                    </div>

                    <!-- Selector de Fecha/Hora (Simplificado) -->
                    <div class="bg-white p-5 rounded-2xl shadow-lg border border-gray-100">
                        <h3 class="text-lg font-bold text-gray-800 mb-3">Selecciona Fecha y Hora</h3>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Fecha Preferida</label>
                        <input type="date" value="2025-12-01" class="w-full p-3 border border-gray-300 rounded-xl mb-4">
                        
                        <label class="block text-sm font-medium text-gray-700 mb-1">Hora Disponible</label>
                        <select class="w-full p-3 border border-gray-300 rounded-xl">
                            <option>09:00 AM</option>
                            <option>11:30 AM</option>
                            <option>03:00 PM</option>
                        </select>
                    </div>

                    <!-- Bot贸n de Acci贸n -->
                    <button onclick="openModal('modal-appointment-confirm')" class="w-full bg-primary hover:bg-blue-700 text-white font-bold py-4 px-4 rounded-xl shadow-xl transition duration-150 transform hover:scale-[1.02]">
                        Agendar Cita (Pagar S/ 60)
                    </button>
                </div>
            `
        };

        function renderContent(pageId) {
            contentDiv.innerHTML = pages[pageId];
        }
        
        // Funci贸n para renderizar el historial de bit谩cora
        function renderLogList() {
            const logList = document.getElementById('log-list');
            if (!logList) return;

            // Ordenar por hora (el m谩s reciente primero)
            const sortedEntries = [...logEntries].reverse();
            
            logList.innerHTML = sortedEntries.map(entry => `
                <li class="p-2 bg-gray-50 rounded-lg flex justify-between items-center border-l-4 ${entry.color}">
                    <span class="font-medium">${entry.content}</span>
                </li>
            `).join('');

            // Si est谩 vac铆o, mostrar un mensaje
            if (logEntries.length === 0) {
                logList.innerHTML = '<li class="text-center text-gray-500 py-4">A煤n no hay registros hoy. 隆Empieza ahora!</li>';
            }
        }

        // --- Funcionalidad del Dashboard y Log ---
        function recordEmotion(emotion) {
            const statusElement = document.getElementById('emotion-status');
            const now = new Date();
            const time = now.toLocaleTimeString('es-PE', { hour: '2-digit', minute: '2-digit' });

            statusElement.textContent = `隆Emoci贸n registrada! Te sientes: ${emotion}`;
            
            let colorClass = 'border-success';
            let alertNeeded = false;

            if (emotion.includes('Estresado') || emotion.includes('Cansado') || emotion.includes('Culpable')) {
                colorClass = 'border-danger';
                alertNeeded = true;
            }

            // A帽adir al array de Bit谩cora
            logEntries.push({
                time: time,
                type: 'Emoci贸n',
                content: `${time}: Emoci贸n registrada (${emotion})`,
                color: colorClass
            });

            // Mostrar el Kit de Calma si es necesario (Prueba de Interacci贸n)
            if (alertNeeded) {
                openModal('modal-kit');
            }
            
            // Si la vista actual es la bit谩cora, la re-renderizamos
            if (currentPage === 'log') {
                renderLogList();
            }
        }

        function logEntry(type) {
            const now = new Date();
            const time = now.toLocaleTimeString('es-PE', { hour: '2-digit', minute: '2-digit' });

            let colorClass = 'border-primary';
            let content = `Registro: ${type}`;

            if (type.includes('Antojo')) {
                colorClass = 'border-red-400';
                content = `${time}: Cuidado con el Antojo! (Comida de la calle)`;
            } else if (type.includes('Casa')) {
                colorClass = 'border-success';
                content = `${time}: Comida: Casa (Buena elecci贸n!)`;
            } else {
                content = `${time}: Comida: Calle`;
            }
            
            // A帽adir al array de Bit谩cora
            logEntries.push({
                time: time,
                type: 'Comida',
                content: content,
                color: colorClass
            });
            
            // Mostrar mensaje de confirmaci贸n temporal
            const msg = document.createElement('div');
            msg.className = 'fixed top-20 right-4 p-3 bg-primary text-white rounded-xl shadow-lg transition duration-300';
            msg.textContent = '隆Bit谩cora actualizada!';
            document.body.appendChild(msg);
            setTimeout(() => msg.remove(), 2000);
            
            // Si la vista actual es la bit谩cora, la re-renderizamos
            if (currentPage === 'log') {
                renderLogList();
            }
        }

        function startCalmKit() {
            closeModal('modal-kit');
            // Simulaci贸n de un kit de calma (ej. t茅cnica 5-4-3-2-1)
            const msg = document.createElement('div');
            msg.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 p-5 bg-yellow-400 text-gray-800 rounded-2xl shadow-2xl font-extrabold text-lg text-center';
            msg.textContent = '5 COSAS que puedes ver... RESPIRA.';
            document.body.appendChild(msg);
            setTimeout(() => {
                msg.textContent = '4 COSAS que puedes tocar... RESPIRA.';
                setTimeout(() => {
                    msg.textContent = '隆Calma restaurada! Sigue con tu d铆a.';
                    setTimeout(() => msg.remove(), 2000);
                }, 3000);
            }, 3000);
        }

        // --- Manejo de Modales y Pago ---
        function openModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
            document.getElementById(modalId).classList.add('flex');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
            document.getElementById(modalId).classList.remove('flex');
        }

        function processPayment() {
            closeModal('modal-appointment-confirm');
            loadingOverlay.style.display = 'flex';

            // Simular un proceso de pago as铆ncrono (Viabilidad)
            setTimeout(() => {
                loadingOverlay.style.display = 'none';
                
                // Mostrar confirmaci贸n
                const confirmation = document.createElement('div');
                confirmation.className = 'fixed top-20 right-4 p-4 bg-green-600 text-white rounded-xl shadow-lg transition duration-300';
                confirmation.innerHTML = '<strong class="font-bold">隆Cita Agendada!</strong> Tu cita de S/ 60 ha sido confirmada. Revisa tu correo.';
                document.body.appendChild(confirmation);
                setTimeout(() => confirmation.remove(), 5000);

                // Redirigir al inicio despu茅s de la confirmaci贸n
                showPage('home');

            }, 3000); // 3 segundos de simulaci贸n de carga
        }


        // Iniciar la aplicaci贸n en la p谩gina de bienvenida
        document.addEventListener('DOMContentLoaded', () => {
            showPage('welcome');
        });

    </script>
</body>
</html>
